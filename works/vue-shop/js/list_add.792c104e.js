(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["list_add"],{"1caf":function(e,t,a){"use strict";var r=a("f00d"),s=a.n(r);s.a},"281c":function(e,t,a){},"4f9b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("商品管理")]),a("el-breadcrumb-item",[e._v("添加商品")])],1),a("el-card",[[a("el-alert",{attrs:{title:"添加商品信息",type:"info","show-icon":"",center:"",closable:!1}}),a("el-steps",{attrs:{active:e.active-0,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"基本信息"}}),a("el-step",{attrs:{title:"商品参数"}}),a("el-step",{attrs:{title:"商品属性"}}),a("el-step",{attrs:{title:"商品图片"}}),a("el-step",{attrs:{title:"商品内容"}}),a("el-step",{attrs:{title:"完成"}})],1),a("el-form",{ref:"TabsFormRef",attrs:{rules:e.TabsFormRules,model:e.TabsForm,"label-width":"100px","label-position":"top"}},[a("el-tabs",{attrs:{"tab-position":e.tabPosition,"before-leave":e.beforeTableLeave},on:{"tab-click":e.getTabIndex},model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[a("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[a("el-input",{model:{value:e.TabsForm.goods_name,callback:function(t){e.$set(e.TabsForm,"goods_name",t)},expression:"TabsForm.goods_name"}})],1),a("el-form-item",{attrs:{label:"商品价格",prop:"goods_price"}},[a("el-input",{attrs:{type:"number"},model:{value:e.TabsForm.goods_price,callback:function(t){e.$set(e.TabsForm,"goods_price",t)},expression:"TabsForm.goods_price"}})],1),a("el-form-item",{attrs:{label:"商品重量",prop:"goods_weight"}},[a("el-input",{attrs:{type:"number"},model:{value:e.TabsForm.goods_weight,callback:function(t){e.$set(e.TabsForm,"goods_weight",t)},expression:"TabsForm.goods_weight"}})],1),a("el-form-item",{attrs:{label:"商品数量",prop:"goods_number"}},[a("el-input",{attrs:{type:"number"},model:{value:e.TabsForm.goods_number,callback:function(t){e.$set(e.TabsForm,"goods_number",t)},expression:"TabsForm.goods_number"}})],1),a("el-form-item",{attrs:{label:"商品分类",prop:"goods_cat"}},[a("el-cascader",{staticClass:"Topdis",attrs:{options:e.cateListtotal,props:e.cateprops,clearable:""},on:{change:e.SelectedCateChanged},model:{value:e.TabsForm.goods_cat,callback:function(t){e.$set(e.TabsForm,"goods_cat",t)},expression:"TabsForm.goods_cat"}})],1)],1),a("el-tab-pane",{attrs:{label:"商品参数",name:"1"}},e._l(e.manyTableArr,(function(t){return a("el-form-item",{key:t.attr_id,attrs:{label:t.attr_name}},[[a("el-checkbox-group",{model:{value:t.attr_vals,callback:function(a){e.$set(t,"attr_vals",a)},expression:"item.attr_vals"}},e._l(t.attr_vals,(function(e,t){return a("el-checkbox",{key:t,attrs:{label:e,border:""}})})),1)]],2)})),1),a("el-tab-pane",{attrs:{label:"商品属性",name:"2"}},e._l(e.onlyTableArr,(function(t){return a("el-form-item",{key:t.attr_id,attrs:{label:t.attr_name}},[a("el-input",{model:{value:t.attr_vals,callback:function(a){e.$set(t,"attr_vals",a)},expression:"item.attr_vals"}})],1)})),1),a("el-tab-pane",{attrs:{label:"商品图片",name:"3"}},[a("el-upload",{attrs:{action:e.uploadImgUrl,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"list-type":"picture",headers:e.headerObj,"on-success":e.handlSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),a("el-tab-pane",{attrs:{label:"商品内容",name:"4"}},[a("quill-editor",{ref:"myQuillEditor",model:{value:e.TabsForm.goods_introduce,callback:function(t){e.$set(e.TabsForm,"goods_introduce",t)},expression:"TabsForm.goods_introduce"}}),a("el-button",{staticClass:"btn-add",attrs:{type:"primary"},on:{click:e.addGoodsSubmit}},[e._v("添加商品")])],1)],1)],1),a("el-dialog",{attrs:{title:"预览图片",visible:e.ImagedialogVisible,width:"50%","before-close":e.handleCloseImg},on:{"update:visible":function(t){e.ImagedialogVisible=t}}},[a("img",{staticClass:"imgClass",attrs:{src:e.previewUrl,alt:""}})])]],2)],1)},s=[],o=(a("c740"),a("4160"),a("a15b"),a("fb6a"),a("d3b7"),a("ac1f"),a("1276"),a("159b"),a("96cf"),a("60bb")),n=a.n(o),i={data:function(){return{active:"0",tabPosition:"left",cateListtotal:[],TabsForm:{goods_name:"",goods_price:0,goods_number:0,goods_weight:0,goods_cat:[],pics:[],goods_introduce:"",attrs:[]},TabsFormRules:{goods_name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],goods_price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],goods_number:[{required:!0,message:"请输入商品数量",trigger:"blur"}],goods_weight:[{required:!0,message:"请输入商品重量",trigger:"blur"}],goods_cat:[{required:!0,message:"请输选择商品分类",trigger:"blur"}]},manyTableArr:[],onlyTableArr:[],cateprops:{expandTrigger:"hover",label:"cat_name",value:"cat_id",children:"children"},previewUrl:"",uploadImgUrl:"http://127.0.0.1:8888/api/private/v1/upload",headerObj:{Authorization:window.sessionStorage.getItem("token")},ImagedialogVisible:!1}},methods:{getCateList:function(){var e,t;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this.$http.get("categories"));case 2:e=a.sent,t=e.data,200==t.meta.status?this.cateListtotal=t.data:this.$message.error(t.meta.status);case 5:case"end":return a.stop()}}),null,this)},SelectedCateChanged:function(e){3===e.length||(this.TabsForm.goods_cat=[])},beforeTableLeave:function(e,t){if(0==t&&3!==this.TabsForm.goods_cat.length)return this.$message.error("请先填写商品分类！"),!1},handlePreview:function(e){this.previewUrl=e.response.data.url,this.ImagedialogVisible=!0},handleCloseImg:function(){this.ImagedialogVisible=!1},handleRemove:function(e){e.response.data.tmp_path;var t=this.TabsForm.pics.findIndex((function(e){e.pic}));this.TabsForm.pics.slice(t,1)},handlSuccess:function(e){var t={pic:e.data.tmp_path};this.TabsForm.pics.push(t)},getTabIndex:function(){var e,t,a,r;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:if("1"!=this.active){s.next=13;break}return s.next=3,regeneratorRuntime.awrap(this.$http.get("categories/".concat(this.cateId,"/attributes"),{params:{sel:"many"}}));case 3:if(e=s.sent,t=e.data,200!=t.meta.status){s.next=10;break}t.data.forEach((function(e){e.attr_vals=0==e.attr_vals.length?[]:e.attr_vals.split(",")})),this.manyTableArr=t.data,s.next=11;break;case 10:return s.abrupt("return",this.$message.error("获取列表失败"));case 11:s.next=19;break;case 13:if("2"!=this.active){s.next=19;break}return s.next=16,regeneratorRuntime.awrap(this.$http.get("categories/".concat(this.cateId,"/attributes"),{params:{sel:"only"}}));case 16:a=s.sent,r=a.data,200==r.meta.status?this.onlyTableArr=r.data:this.$message.error(r.meta.msg);case 19:case"end":return s.stop()}}),null,this)},addGoodsSubmit:function(){var e=this;this.$refs.TabsFormRef.validate((function(t){var a,r,s;return regeneratorRuntime.async((function(o){while(1)switch(o.prev=o.next){case 0:if(t){o.next=2;break}return o.abrupt("return",e.$message.error("请填写必填项！"));case 2:return a=n.a.cloneDeep(e.TabsForm),a.goods_cat=a.goods_cat.join(","),e.manyTableArr.forEach((function(t){var a={attr_id:t.attr_id,attr_value:t.attr_vals.join(" ")};e.TabsForm.attrs.push(a)})),e.manyTableArr.forEach((function(t){var a={attr_id:t.attr_id,attr_value:t.attr_vals};e.TabsForm.attrs.push(a)})),a.attrs=e.TabsForm.attrs,o.next=9,regeneratorRuntime.awrap(e.$http.post("goods",a));case 9:if(r=o.sent,s=r.data,201!=s.meta.status){o.next=15;break}e.$message.success(s.meta.msg),o.next=16;break;case 15:return o.abrupt("return",e.$message.error(s.meta.msg));case 16:case"end":return o.stop()}}))}))}},created:function(){this.getCateList()},computed:{cateId:function(){return 3==this.TabsForm.goods_cat.length?this.TabsForm.goods_cat[2]:null}}},l=i,c=(a("1caf"),a("2877")),u=Object(c["a"])(l,r,s,!1,null,"b1900a02",null);t["default"]=u.exports},a9cc:function(e,t,a){"use strict";var r=a("281c"),s=a.n(r);s.a},c740:function(e,t,a){"use strict";var r=a("23e7"),s=a("b727").findIndex,o=a("44d2"),n="findIndex",i=!0;n in[]&&Array(1)[n]((function(){i=!1})),r({target:"Array",proto:!0,forced:i},{findIndex:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),o(n)},efde:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("商品管理")]),a("el-breadcrumb-item",[e._v("商品列表")])],1),a("el-card",[[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{placeholder:"请输入搜索内容",clearable:""},on:{clear:e.initGoodsData},model:{value:e.query.query,callback:function(t){e.$set(e.query,"query",t)},expression:"query.query"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.initGoodsData},slot:"append"})],1)],1),a("el-col",{staticClass:"dis-left",attrs:{span:4}},[a("el-button",{attrs:{type:"primary"},on:{click:e.goAddpage}},[e._v("添加商品")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.goodsData,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index"}}),a("el-table-column",{attrs:{prop:"goods_name",label:"商品名称"}}),a("el-table-column",{attrs:{prop:"goods_price",width:"95px",label:"商品价格(元)"}}),a("el-table-column",{attrs:{prop:"goods_weight",width:"70px",label:"商品重量"}}),a("el-table-column",{attrs:{width:"160px",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateFormat")(t.row.add_time))+" ")]}}])}),a("el-table-column",{attrs:{label:"操作",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(a){return e.editGood(t.row.goods_id)}}}),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.delGood(t.row.goods_id)}}})]}}])})],1),a("el-pagination",{staticClass:"dis-page",attrs:{"current-page":e.query.pagenum,"page-sizes":[10,20,50,100],"page-size":e.query.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})]],2)],1)},s=[],o=(a("d3b7"),a("96cf"),{data:function(){return{goodsData:[],query:{query:"",pagenum:1,pagesize:10},total:0}},methods:{initGoodsData:function(){var e,t;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this.$http.get("goods",{params:this.query}));case 2:if(e=a.sent,t=e.data,200!=t.meta.status){a.next=9;break}this.goodsData=t.data.goods,this.total=t.data.total,a.next=10;break;case 9:return a.abrupt("return",this.$message.error(t.meta.msg));case 10:case"end":return a.stop()}}),null,this)},goAddpage:function(){this.$router.push("goods/add")},handleSizeChange:function(e){this.query.pagesize=e,this.initGoodsData()},handleCurrentChange:function(e){this.query.pagenum=e,this.initGoodsData()},delGood:function(e){var t=this;this.$confirm("确定删除商品吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a,r;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,regeneratorRuntime.awrap(t.$http.delete("goods/".concat(e)));case 2:a=s.sent,r=a.data,200==r.meta.status?(t.$message.success(r.meta.msg),t.initGoodsData()):t.$message.error(r.meta.msg);case 5:case"end":return s.stop()}}))})).catch((function(){t.$message.info("已取消删除！")}))},editGood:function(){}},created:function(){this.initGoodsData()}}),n=o,i=(a("a9cc"),a("2877")),l=Object(i["a"])(n,r,s,!1,null,"06235b39",null);t["default"]=l.exports},f00d:function(e,t,a){},fb6a:function(e,t,a){"use strict";var r=a("23e7"),s=a("861d"),o=a("e8b5"),n=a("23cb"),i=a("50c4"),l=a("fc6a"),c=a("8418"),u=a("1dde"),d=a("b622"),m=d("species"),p=[].slice,b=Math.max;r({target:"Array",proto:!0,forced:!u("slice")},{slice:function(e,t){var a,r,u,d=l(this),g=i(d.length),h=n(e,g),f=n(void 0===t?g:t,g);if(o(d)&&(a=d.constructor,"function"!=typeof a||a!==Array&&!o(a.prototype)?s(a)&&(a=a[m],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return p.call(d,h,f);for(r=new(void 0===a?Array:a)(b(f-h,0)),u=0;h<f;h++,u++)h in d&&c(r,u,d[h]);return r.length=u,r}})}}]);
//# sourceMappingURL=list_add.792c104e.js.map