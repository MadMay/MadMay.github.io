(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["cate_params"],{"170b":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("商品分类")]),a("el-breadcrumb-item",[t._v("商品管理")])],1),a("el-card",[a("el-row",[a("el-col",[a("el-button",{attrs:{type:"primary"},on:{click:t.showcatelog}},[t._v("添加分类")])],1)],1),a("tree-table",{staticClass:"treeTable",attrs:{data:t.catelist,"show-index":!0,border:"","index-text":"#",columns:t.columns,"selection-type":!1,"expand-type":!1},scopedSlots:t._u([{key:"isok",fn:function(t){return[0==t.row.cat_deleted?a("i",{staticClass:"el-icon-success",staticStyle:{color:"lightgreen"}}):a("i",{staticClass:"el-icon-error",staticStyle:{color:"red"}})]}},{key:"order",fn:function(e){return[0==e.row.cat_level?a("el-tag",{attrs:{size:"mini"}},[t._v("一级")]):1==e.row.cat_level?a("el-tag",{attrs:{type:"success",size:"mini"}},[t._v("二级")]):a("el-tag",{attrs:{type:"warning",size:"mini"}},[t._v("三级")])]}},{key:"opt",fn:function(e){return[t._v(" "+t._s(e.col)+" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"}},[t._v("删除")])]}}])}),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":t.queryInfo.pagenum,"page-sizes":[5,10,20,50],"page-size":t.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),a("el-dialog",{attrs:{title:"提示",visible:t.addcatdialogVisible,width:"500px"},on:{"update:visible":function(e){t.addcatdialogVisible=e},close:t.closeAddCateDialog}},[a("el-form",{ref:"addcateFormRef",attrs:{"label-width":"80px",model:t.addcateForm,rules:t.addcateFormRules}},[a("el-form-item",{attrs:{label:"分类名称",prop:"cat_name"}},[a("el-input",{model:{value:t.addcateForm.cat_name,callback:function(e){t.$set(t.addcateForm,"cat_name",e)},expression:"addcateForm.cat_name"}})],1),a("el-form-item",{attrs:{label:"父级分类"}},[a("el-cascader",{staticClass:"fullScreen",attrs:{options:t.parentcatelist,props:t.catelistprops,clearable:"","change-on-select":!0},on:{change:t.parentCateChanged},model:{value:t.selectedKeys,callback:function(e){t.selectedKeys=e},expression:"selectedKeys"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addcatdialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addcatesubmit}},[t._v("确 定")])],1)],1)],1)},s=[],n=(a("d3b7"),a("96cf"),{data:function(){return{catelist:[],queryInfo:{type:3,pagenum:1,pagesize:5},addcatdialogVisible:!1,addcateForm:{cat_name:"",cat_pid:0,cat_level:0},total:0,columns:[{label:"分类名称",prop:"cat_name"},{label:"是否有效",type:"template",template:"isok"},{label:"排序",type:"template",template:"order"},{label:"操作",type:"template",template:"opt"}],addcateFormRules:{cat_name:[{required:!0,message:"请输入分类名称",trigger:"blur"}]},parentcatelist:[],catelistprops:{expandTrigger:"hover",label:"cat_name",value:"cat_id",children:"children"},selectedKeys:[]}},methods:{initcatelist:function(){var t,e;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this.$http.get("categories",{params:this.queryInfo}));case 2:t=a.sent,e=t.data,200==e.meta.status?(this.catelist=e.data.result,this.total=e.data.total):this.$message.error(e.meta.msg);case 5:case"end":return a.stop()}}),null,this)},getParentCateList:function(){var t,e;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this.$http.get("categories",{params:{type:2}}));case 2:t=a.sent,e=t.data,200==e.meta.status?this.parentcatelist=e.data:this.$message.error(e.meta.msg);case 5:case"end":return a.stop()}}),null,this)},parentCateChanged:function(){if(this.selectedKeys.length>0)return this.addcateForm.cat_id=this.selectedKeys[this.selectedKeys.length-1],void(this.addcateForm.cat_level=this.selectedKeys.length);this.addcateForm.cat_id=0,this.addcateForm.cat_level=0},closeAddCateDialog:function(){this.$refs["addcateFormRef"].resetFields(),this.selectedKeys=[],this.addcateForm.cat_pid=0,this.addcateForm.cat_level=0},addcatesubmit:function(){var t=this;this.$refs["addcateFormRef"].validate((function(e){var a,r;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:if(e){s.next=4;break}return s.abrupt("return");case 4:return s.next=6,regeneratorRuntime.awrap(t.$http.post("categories",t.addcateForm));case 6:a=s.sent,r=a.data,201==r.meta.status?(t.$message.success(r.meta.msg),t.initcatelist()):t.$message.error(r.meta.status),t.addcatdialogVisible=!1;case 10:case"end":return s.stop()}}))}))},showcatelog:function(){this.getParentCateList(),this.addcatdialogVisible=!0},handleSizeChange:function(t){this.queryInfo.pagesize=t,this.initcatelist()},handleCurrentChange:function(t){this.queryInfo.pagenum=t,this.initcatelist()}},created:function(){this.initcatelist()}}),i=n,l=(a("fa72"),a("2877")),c=Object(l["a"])(i,r,s,!1,null,"e8c0250a",null);e["default"]=c.exports},"3a41":function(t,e,a){},4550:function(t,e,a){},"498a":function(t,e,a){"use strict";var r=a("23e7"),s=a("58a8").trim,n=a("e070");r({target:"String",proto:!0,forced:n("trim")},{trim:function(){return s(this)}})},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,a){var r=a("1d80"),s=a("5899"),n="["+s+"]",i=RegExp("^"+n+n+"*"),l=RegExp(n+n+"*$"),c=function(t){return function(e){var a=String(r(e));return 1&t&&(a=a.replace(i,"")),2&t&&(a=a.replace(l,"")),a}};t.exports={start:c(1),end:c(2),trim:c(3)}},a434:function(t,e,a){"use strict";var r=a("23e7"),s=a("23cb"),n=a("a691"),i=a("50c4"),l=a("7b0b"),c=a("65f0"),o=a("8418"),u=a("1dde"),d=Math.max,m=Math.min,p=9007199254740991,f="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!u("splice")},{splice:function(t,e){var a,r,u,g,h,b,v=l(this),y=i(v.length),_=s(t,y),w=arguments.length;if(0===w?a=r=0:1===w?(a=0,r=y-_):(a=w-2,r=m(d(n(e),0),y-_)),y+a-r>p)throw TypeError(f);for(u=c(v,r),g=0;g<r;g++)h=_+g,h in v&&o(u,g,v[h]);if(u.length=r,a<r){for(g=_;g<y-r;g++)h=g+r,b=g+a,h in v?v[b]=v[h]:delete v[b];for(g=y;g>y-r+a;g--)delete v[g-1]}else if(a>r)for(g=y-r;g>_;g--)h=g+r-1,b=g+a-1,h in v?v[b]=v[h]:delete v[b];for(g=0;g<a;g++)v[g+_]=arguments[g+2];return v.length=y-r+a,u}})},a652:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("商品管理")]),a("el-breadcrumb-item",[t._v("分类参数")])],1),a("el-card",[a("el-alert",{attrs:{type:"warning",closable:!1}},[a("i",{staticClass:"el-icon-warning"}),t._v("注意:只允许为第三级分类设置相关参数")]),a("span",{staticClass:"right-dis"},[t._v("选择商品分类:")]),a("el-cascader",{staticClass:"Topdis",attrs:{options:t.cateListtotal,props:t.cateprops,clearable:""},on:{change:t.SelectedCateChanged},model:{value:t.selectedgetKeys,callback:function(e){t.selectedgetKeys=e},expression:"selectedgetKeys"}}),a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"动态参数",name:"many",disabled:t.isBtnDisabled}},[a("el-button",{staticClass:"btn-opt",attrs:{type:"primary",disabled:t.isBtnDisabled},on:{click:t.showAddParamDialog}},[t._v("添加参数")]),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.manyTableData}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.attr_vals,(function(r,s){return a("el-tag",{key:s,attrs:{closable:""},on:{close:function(a){return t.removeTag(s,e.row)}}},[t._v(t._s(r))])})),e.row.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(a){return t.handleInputConfirm(e.row)}},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.handleInputConfirm(e.row)}},model:{value:e.row.inputValue,callback:function(a){t.$set(e.row,"inputValue",a)},expression:"scope.row.inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(a){return t.showInput(e.row)}}},[t._v("+ New Tag")])]}}])}),a("el-table-column",{attrs:{type:"index"}}),a("el-table-column",{attrs:{label:"参数名称",prop:"attr_name"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(a){return t.editParams(e.row.attr_id)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(a){return t.delParams(e.row.attr_id)}}},[t._v("删除")])]}}])})],1)],1),a("el-tab-pane",{attrs:{label:"静态属性",name:"only",disabled:t.isBtnDisabled}},[a("el-button",{staticClass:"btn-opt",attrs:{type:"primary",disabled:t.isBtnDisabled},on:{click:function(e){t.addParamsdialogVisible=!0}}},[t._v("添加参数")]),a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:t.onlyTableData}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(e.row.attr_vals,(function(e,r){return a("el-tag",{key:r,attrs:{closable:""}},[t._v(t._s(e))])})),e.row.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:function(a){return t.handleInputConfirm(e.row)}},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.handleInputConfirm(e.row)}},model:{value:e.row.inputValue,callback:function(a){t.$set(e.row,"inputValue",a)},expression:"scope.row.inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:function(a){return t.showInput(e.row)}}},[t._v("+ New Tag")])]}}])}),a("el-table-column",{attrs:{type:"index"}}),a("el-table-column",{attrs:{label:"参数名称",prop:"attr_name"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",icon:"el-icon-edit"},on:{click:function(a){return t.editParams(e.row.attr_id)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(a){return t.delParams(e.row.attr_id)}}},[t._v("删除")])]}}])})],1)],1)],1),a("el-dialog",{attrs:{title:"添加"+t.titleText,visible:t.addParamsdialogVisible,width:"40%"},on:{"update:visible":function(e){t.addParamsdialogVisible=e},close:t.addParamsClose}},[a("el-form",{ref:"addParamsRef",attrs:{model:t.addParamsData,rules:t.addParamsRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:t.titleText,prop:"attr_name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.addParamsData.attr_name,callback:function(e){t.$set(t.addParamsData,"attr_name",e)},expression:"addParamsData.attr_name"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addParamsdialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addParamsSubmit}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"修改"+t.titleText,visible:t.editParamsdialogVisible,width:"40%"},on:{"update:visible":function(e){t.editParamsdialogVisible=e},close:t.editParamsClose}},[a("el-form",{ref:"editParamsRef",attrs:{model:t.editParamsData,rules:t.editParamsRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:t.titleText,prop:"attr_name"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.editParamsData.attr_name,callback:function(e){t.$set(t.editParamsData,"attr_name",e)},expression:"editParamsData.attr_name"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.editParamsdialogVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.editParamsSubmit}},[t._v("确 定")])],1)],1)],1)],1)},s=[],n=(a("99af"),a("4160"),a("a15b"),a("a434"),a("d3b7"),a("ac1f"),a("1276"),a("498a"),a("159b"),a("96cf"),{data:function(){return{cateListtotal:[],cateprops:{label:"cat_name",value:"cat_id",children:"children"},selectedgetKeys:[],activeName:"many",addParamsData:{attr_name:""},editParamsData:{attr_name:""},manyTableData:[],onlyTableData:[],addParamsdialogVisible:!1,editParamsdialogVisible:!1,addParamsRules:{attr_name:[{required:!0,message:"请输入参数名称",trigger:"blur"}]},editParamsRules:{attr_name:[{required:!0,message:"请输入参数名称",trigger:"blur"}]}}},methods:{initCateList:function(){var t,e;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,regeneratorRuntime.awrap(this.$http.get("categories"));case 2:t=a.sent,e=t.data,200==e.meta.status?this.cateListtotal=e.data:this.$message.error(e.meta.msg);case 5:case"end":return a.stop()}}),null,this)},SelectedCateChanged:function(){this.getParamsDate()},handleClick:function(){this.getParamsDate()},showAddParamDialog:function(){this.addParamsdialogVisible=!0},addParamsClose:function(){this.$refs.addParamsRef.resetFields()},getParamsDate:function(){var t,e;return regeneratorRuntime.async((function(a){while(1)switch(a.prev=a.next){case 0:if(3===this.selectedgetKeys.length){a.next=5;break}return this.selectedgetKeys=[],this.manyTableData=[],this.onlyTableData=[],a.abrupt("return");case 5:return a.next=7,regeneratorRuntime.awrap(this.$http.get("categories/".concat(this.cateId,"/attributes"),{params:{sel:this.activeName}}));case 7:if(t=a.sent,e=t.data,e.data.forEach((function(t){t.attr_vals=t.attr_vals?t.attr_vals.split(","):[],t.inputVisible=!1,t.inputValue=""})),200!=e.meta.status){a.next=14;break}"many"==this.activeName?this.manyTableData=e.data:this.onlyTableData=e.data,a.next=15;break;case 14:return a.abrupt("return",this.$message.error(e.meta.status));case 15:case"end":return a.stop()}}),null,this)},addParamsSubmit:function(){var t=this;this.$refs.addParamsRef.validate((function(e){var a,r;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:if(e){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,regeneratorRuntime.awrap(t.$http.post("categories/".concat(t.cateId,"/attributes"),{attr_name:t.addParamsData.attr_name,attr_sel:t.activeName}));case 4:a=s.sent,r=a.data,201==r.meta.status?(t.$message.success(r.meta.msg),t.addParamsdialogVisible=!1,t.getParamsDate()):t.$message.error(r.meta.msg);case 7:case"end":return s.stop()}}))}))},editParams:function(t){var e,a;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return this.editParamsdialogVisible=!0,r.next=3,regeneratorRuntime.awrap(this.$http.get("categories/".concat(this.cateId,"/attributes/").concat(t),{params:{attr_sel:this.activeName}}));case 3:if(e=r.sent,a=e.data,200!=a.meta.status){r.next=9;break}this.editParamsData=a.data,r.next=10;break;case 9:return r.abrupt("return",this.$message.error(a.meta.msg));case 10:case"end":return r.stop()}}),null,this)},delParams:function(t){var e=this;this.$confirm("是否删除参数?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a,r;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,regeneratorRuntime.awrap(e.$http.delete("categories/".concat(e.cateId,"/attributes/").concat(t)));case 2:if(a=s.sent,r=a.data,200!=r.meta.status){s.next=9;break}e.$message({type:"success",message:"删除成功!"}),e.getParamsDate(),s.next=10;break;case 9:return s.abrupt("return",e.$message.error(r.meta.msg));case 10:case"end":return s.stop()}}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},editParamsClose:function(){this.$refs.editParamsRef.resetFields()},editParamsSubmit:function(){var t=this;this.$refs.editParamsRef.validate((function(e){var a,r;return regeneratorRuntime.async((function(s){while(1)switch(s.prev=s.next){case 0:if(e){s.next=2;break}return s.abrupt("return");case 2:return s.next=4,regeneratorRuntime.awrap(t.$http.put("categories/".concat(t.cateId,"/attributes/").concat(t.editParamsData.attr_id),{attr_name:t.editParamsData.attr_name,attr_sel:t.activeName}));case 4:a=s.sent,r=a.data,200==r.meta.status?t.$message.success(r.meta.msg):t.$message.error(r.meta.msg),t.editParamsdialogVisible=!1,t.getParamsDate();case 9:case"end":return s.stop()}}))}))},handleInputConfirm:function(t){if(0===t.inputValue.trim().length)return t.inputValue="",void(t.inputVisible=!1);t.attr_vals.push(t.inputValue),this.saveAttrValues(t),t.inputValue="",t.inputVisible=!1},saveAttrValues:function(t){var e,a;return regeneratorRuntime.async((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(this.$http.put("categories/".concat(this.cateId,"/attributes/").concat(t.attr_id),{attr_name:t.attr_name,attr_sel:t.attr_sel,attr_vals:t.attr_vals.join(",")}));case 2:e=r.sent,a=e.data,200==a.meta.status?this.$message.success(a.meta.msg):this.$message.error(a.meta.msg);case 5:case"end":return r.stop()}}),null,this)},showInput:function(t){var e=this;t.inputVisible=!0,this.$nextTick((function(t){e.$refs.saveTagInput.$refs.input.focus()}))},removeTag:function(t,e){e.attr_vals.splice(t,1),this.saveAttrValues(e)}},created:function(){this.initCateList()},computed:{isBtnDisabled:function(){return 3!==this.selectedgetKeys.length},cateId:function(){return 3===this.selectedgetKeys.length?this.selectedgetKeys[2]:null},titleText:function(){return"many"===this.activeName?"动态参数":"静态属性"}}}),i=n,l=(a("c2a4"),a("2877")),c=Object(l["a"])(i,r,s,!1,null,"44286e31",null);e["default"]=c.exports},c2a4:function(t,e,a){"use strict";var r=a("4550"),s=a.n(r);s.a},e070:function(t,e,a){var r=a("d039"),s=a("5899"),n="​᠎";t.exports=function(t){return r((function(){return!!s[t]()||n[t]()!=n||s[t].name!==t}))}},fa72:function(t,e,a){"use strict";var r=a("3a41"),s=a.n(r);s.a}}]);
//# sourceMappingURL=cate_params.3b283936.js.map